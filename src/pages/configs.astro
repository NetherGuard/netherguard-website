---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="Config Manager - NetherGuard" description="Build optimized plugin configurations with security presets and performance tuning best practices.">
  <!-- Hero Section -->
  <section class="section-spacing bg-gradient-to-br from-obsidian-900 via-zinc-900/20 to-obsidian-900">
    <div class="container">
      <div class="max-w-4xl mx-auto text-center mb-12">
        <div class="text-sm text-zinc-500 font-mono mb-4">~/config-manager</div>
        <h1 class="text-5xl md:text-6xl font-bold text-white mb-6 leading-tight">
          Config <span class="text-white">Manager</span>
        </h1>
        <p class="text-xl text-zinc-400 max-w-2xl mx-auto leading-relaxed">
          Build optimized plugin configurations with security presets and performance tuning.
          Best practices included by default.
        </p>
      </div>
    </div>
  </section>

  <!-- Generator Section -->
  <section class="section-spacing bg-obsidian-800">
    <div class="container">
      <div class="max-w-4xl mx-auto space-y-12">
        
        <!-- Plugin Selection -->
        <div>
          <h2 class="text-2xl font-bold text-white mb-6">Select Plugin</h2>
          <div class="bg-obsidian-700/50 border border-zinc-800 rounded-xl p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <button id="essentialsBtn" class="plugin-btn active px-6 py-4 bg-white text-black rounded-lg font-semibold transition-all duration-200 hover:scale-105 text-left">
                <div class="font-bold text-lg">Essentials</div>
                <div class="text-sm opacity-70">Core server commands and utilities</div>
              </button>
              <button id="worldguardBtn" class="plugin-btn px-6 py-4 bg-white/10 border border-white/20 hover:bg-white/20 text-white rounded-lg font-semibold transition-all duration-200 hover:scale-105 text-left">
                <div class="font-bold text-lg">WorldGuard</div>
                <div class="text-sm opacity-70">Region protection and world management</div>
              </button>
              <button id="spigotBtn" class="plugin-btn px-6 py-4 bg-white/10 border border-white/20 hover:bg-white/20 text-white rounded-lg font-semibold transition-all duration-200 hover:scale-105 text-left">
                <div class="font-bold text-lg">Spigot</div>
                <div class="text-sm opacity-70">Server optimization settings</div>
              </button>
              <button id="bukkitBtn" class="plugin-btn px-6 py-4 bg-white/10 border border-white/20 hover:bg-white/20 text-white rounded-lg font-semibold transition-all duration-200 hover:scale-105 text-left">
                <div class="font-bold text-lg">Bukkit</div>
                <div class="text-sm opacity-70">Core server configuration</div>
              </button>
            </div>
          </div>
        </div>

        <!-- Server Type -->
        <div>
          <h2 class="text-2xl font-bold text-white mb-6">Server Type</h2>
          <div class="bg-obsidian-700/50 border border-zinc-800 rounded-xl p-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <button id="survivalBtn" class="server-btn active px-6 py-4 bg-white text-black rounded-lg font-semibold transition-all duration-200 hover:scale-105 text-center">
                <div class="font-bold text-lg">Survival</div>
                <div class="text-sm opacity-70">Standard survival gameplay</div>
              </button>
              <button id="creativeBtn" class="server-btn px-6 py-4 bg-white/10 border border-white/20 hover:bg-white/20 text-white rounded-lg font-semibold transition-all duration-200 hover:scale-105 text-center">
                <div class="font-bold text-lg">Creative</div>
                <div class="text-sm opacity-70">Building and creative mode</div>
              </button>
              <button id="minigamesBtn" class="server-btn px-6 py-4 bg-white/10 border border-white/20 hover:bg-white/20 text-white rounded-lg font-semibold transition-all duration-200 hover:scale-105 text-center">
                <div class="font-bold text-lg">Minigames</div>
                <div class="text-sm opacity-70">PvP and competitive gameplay</div>
              </button>
            </div>
          </div>
        </div>

        <!-- Custom Settings -->
        <div>
          <h2 class="text-2xl font-bold text-white mb-6">Custom Settings</h2>
          <div class="bg-obsidian-700/50 border border-zinc-800 rounded-xl p-6 space-y-8">
            
            <!-- Allow Direct Hat -->
            <div class="flex items-center justify-between">
              <div>
                <h4 class="text-lg font-semibold text-white">Allow Direct Hat</h4>
                <p class="text-zinc-400 text-sm">Allow players to use /hat command directly</p>
              </div>
              <label class="custom-checkbox">
                <input type="checkbox" id="allowDirectHat" checked>
                <span class="checkmark"></span>
              </label>
            </div>

            <!-- Teleport Cooldown -->
            <div>
              <label class="block text-lg font-semibold text-white mb-2">Teleport Cooldown</label>
              <p class="text-zinc-400 text-sm mb-3">Cooldown in seconds for teleport commands</p>
              <input 
                type="number" 
                value="5" 
                min="0" 
                max="300" 
                class="w-full px-4 py-3 bg-obsidian-900 border border-zinc-700 rounded-lg text-white focus:border-white focus:outline-none transition-colors no-arrows"
                id="teleportCooldown"
              />
            </div>

            <!-- Default Gamemode -->
            <div>
              <label class="block text-lg font-semibold text-white mb-2">Default Gamemode</label>
              <p class="text-zinc-400 text-sm mb-3">Default gamemode for new players</p>
              
              <!-- Custom Gamemode Selector -->
              <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                <button 
                  type="button" 
                  class="gamemode-btn active px-4 py-3 bg-white text-black rounded-lg font-medium transition-all duration-200 hover:scale-105 text-center text-sm"
                  data-value="survival"
                >
                  üèπ Survival
                </button>
                <button 
                  type="button" 
                  class="gamemode-btn px-4 py-3 bg-white/10 border border-white/20 hover:bg-white/20 text-white rounded-lg font-medium transition-all duration-200 hover:scale-105 text-center text-sm"
                  data-value="creative"
                >
                  üé® Creative
                </button>
                <button 
                  type="button" 
                  class="gamemode-btn px-4 py-3 bg-white/10 border border-white/20 hover:bg-white/20 text-white rounded-lg font-medium transition-all duration-200 hover:scale-105 text-center text-sm"
                  data-value="adventure"
                >
                  üó∫Ô∏è Adventure
                </button>
                <button 
                  type="button" 
                  class="gamemode-btn px-4 py-3 bg-white/10 border border-white/20 hover:bg-white/20 text-white rounded-lg font-medium transition-all duration-200 hover:scale-105 text-center text-sm"
                  data-value="spectator"
                >
                  üëª Spectator
                </button>
              </div>
              
              <!-- Hidden input para mantener el valor -->
              <input type="hidden" id="defaultGamemode" value="survival">
            </div>

            <!-- Protect Rails -->
            <div class="flex items-center justify-between">
              <div>
                <h4 class="text-lg font-semibold text-white">Protect Rails</h4>
                <p class="text-zinc-400 text-sm">Prevent rail destruction</p>
              </div>
              <label class="custom-checkbox">
                <input type="checkbox" id="protectRails" checked>
                <span class="checkmark"></span>
              </label>
            </div>

            <!-- Max Homes -->
            <div>
              <label class="block text-lg font-semibold text-white mb-2">Max Homes</label>
              <p class="text-zinc-400 text-sm mb-3">Maximum homes per player</p>
              <input 
                type="number" 
                value="3" 
                min="1" 
                max="20" 
                class="w-full px-4 py-3 bg-obsidian-900 border border-zinc-700 rounded-lg text-white focus:border-white focus:outline-none transition-colors no-arrows"
                id="maxHomes"
              />
            </div>

            <!-- Spawn on Join -->
            <div class="flex items-center justify-between">
              <div>
                <h4 class="text-lg font-semibold text-white">Spawn on Join</h4>
                <p class="text-zinc-400 text-sm">Teleport to spawn on first join</p>
              </div>
              <label class="custom-checkbox">
                <input type="checkbox" id="spawnOnJoin">
                <span class="checkmark"></span>
              </label>
            </div>

          </div>
        </div>

        <!-- Generate Button -->
        <div class="text-center">
          <button 
            id="generateBtn"
            class="px-12 py-4 bg-white hover:bg-zinc-200 text-black rounded-xl font-bold text-lg transition-all duration-200 hover:scale-105 shadow-xl"
          >
            Generate Configuration
          </button>
        </div>

        <!-- Output Section -->
        <div id="outputSection" class="hidden">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-white">Generated Configuration</h2>
            <div class="flex gap-2">
              <button 
                id="copyBtn"
                class="px-4 py-2 bg-white/10 border border-white/20 hover:bg-white/20 text-white rounded-lg text-sm font-medium transition-colors"
              >
                Copy to Clipboard
              </button>
              <button 
                id="downloadBtn"
                class="px-4 py-2 bg-white hover:bg-zinc-200 text-black rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105"
              >
                Download YAML
              </button>
            </div>
          </div>

          <div class="bg-obsidian-700/50 border border-zinc-800 rounded-xl p-6">
            <div class="bg-obsidian-900 border border-zinc-700 rounded-lg p-6 font-mono text-sm max-h-[500px] overflow-y-auto">
              <pre id="configOutput" class="text-white whitespace-pre-wrap"></pre>
            </div>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- Toast Container -->
  <div id="toastContainer" class="fixed top-4 right-4 z-50 space-y-2"></div>

  <!-- Features Section -->
  <section class="section-spacing bg-obsidian-900">
    <div class="container">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-3xl font-bold text-white text-center mb-12">Configuration Features</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div class="text-center">
            <div class="w-16 h-16 bg-white/10 rounded-xl flex items-center justify-center mx-auto mb-4">
              <span class="text-2xl font-bold text-white">‚ö°</span>
            </div>
            <h3 class="text-xl font-bold text-white mb-2">Optimized</h3>
            <p class="text-zinc-400">Performance-tuned settings for maximum server TPS and minimal lag.</p>
          </div>
          
          <div class="text-center">
            <div class="w-16 h-16 bg-white/10 rounded-xl flex items-center justify-center mx-auto mb-4">
              <span class="text-2xl font-bold text-white">üõ°Ô∏è</span>
            </div>
            <h3 class="text-xl font-bold text-white mb-2">Secure</h3>
            <p class="text-zinc-400">Built-in security measures to protect against common exploits and grief.</p>
          </div>
          
          <div class="text-center">
            <div class="w-16 h-16 bg-white/10 rounded-xl flex items-center justify-center mx-auto mb-4">
              <span class="text-2xl font-bold text-white">üéØ</span>
            </div>
            <h3 class="text-xl font-bold text-white mb-2">Targeted</h3>
            <p class="text-zinc-400">Customized for your server type with game mode specific optimizations.</p>
          </div>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<script is:inline>
  // Variables globales
  var currentPlugin = 'essentials';
  var currentServerType = 'survival';
  var selectedGamemode = 'survival';
  var isGenerating = false;

  // Templates de configuraci√≥n
  var configTemplates = {
    essentials: {
      survival: `# Essentials Configuration - Survival Mode
# Generated by NetherGuard Config Manager

# Teleport settings
teleport-cooldown: {teleportCooldown}
teleport-delay: 3
teleport-invulnerability: 4

# Economy settings
economy-log: true
baltop-refresh-delay: 300

# Player settings
allow-direct-hat: {allowDirectHat}
default-gamemode: {defaultGamemode}
spawn-on-join: {spawnOnJoin}

# Protection settings
protect:
  rails: {protectRails}
  signs: true
  sign-use: true

# Home settings
max-homes: {maxHomes}
home-radius: 10

# Performance settings
update-check: true
debug: false

# Chat settings
chat:
  format: '<{DISPLAYNAME}> {MESSAGE}'
  group-formats: {}

# Command settings
disabled-commands:
  - nick
  - speed

# Social features
social-spy-commands:
  - msg
  - mail
  - r
  - tell`,
      
      creative: `# Essentials Configuration - Creative Mode
# Generated by NetherGuard Config Manager

# Teleport settings (relaxed for creative)
teleport-cooldown: {teleportCooldown}
teleport-delay: 0
teleport-invulnerability: 0

# Economy settings (disabled for creative)
economy-log: false
baltop-refresh-delay: 600

# Player settings
allow-direct-hat: {allowDirectHat}
default-gamemode: {defaultGamemode}
spawn-on-join: {spawnOnJoin}

# Protection settings (minimal for creative)
protect:
  rails: {protectRails}
  signs: false
  sign-use: false

# Home settings (unlimited for creative)
max-homes: {maxHomes}
home-radius: 0

# Performance settings
update-check: true
debug: false

# Creative specific
give-on-join:
  - 137:1 # Command blocks for builders

# Command settings (enable more commands)
disabled-commands: []`,

      minigames: `# Essentials Configuration - Minigames Mode
# Generated by NetherGuard Config Manager

# Teleport settings (instant for competitive)
teleport-cooldown: {teleportCooldown}
teleport-delay: 0
teleport-invulnerability: 0

# Economy settings
economy-log: true
baltop-refresh-delay: 60

# Player settings
allow-direct-hat: {allowDirectHat}
default-gamemode: {defaultGamemode}
spawn-on-join: {spawnOnJoin}

# Protection settings (high for PvP)
protect:
  rails: {protectRails}
  signs: true
  sign-use: true
  prevent-item-drop: true

# Home settings (restricted for minigames)
max-homes: {maxHomes}
home-radius: 50

# PvP settings
player-command-teleports: false
teleport-safety: false

# Command settings
disabled-commands:
  - home
  - back
  - tp`
    },
    
    worldguard: {
      survival: `# WorldGuard Configuration - Survival Mode
# Generated by NetherGuard Config Manager

# Region settings
regions:
  enable: true
  wand: minecraft:stick
  max-region-count-per-player:
    default: 7

# Protection settings
protection:
  item-drop-blacklist: []
  interaction-whitelist: []
  emit-block-use-at-feet: []
  
# Game rules
gameplay:
  block-potions: []
  block-potions-overly-reliably: true
  disable-health-regain: false

# Spawn settings  
spawn-protection:
  size: 16
  disable-build-protection: false

# Auto settings
auto-invincible: false
auto-invincible-group: false
auto-no-drowning: false
auto-no-drowning-group: false

# Physics
simulation:
  sponge:
    enable: true
    redstone: false`,
    
      creative: `# WorldGuard Configuration - Creative Mode  
# Generated by NetherGuard Config Manager

# Region settings (relaxed for creative)
regions:
  enable: true
  wand: minecraft:stick
  max-region-count-per-player:
    default: 20

# Protection settings (minimal)
protection:
  item-drop-blacklist: []
  interaction-whitelist: []
  
# Game rules (creative friendly)
gameplay:
  block-potions: []
  disable-health-regain: true
  disable-fall-damage: true

# No spawn protection for creative
spawn-protection:
  size: 0
  disable-build-protection: true`,

      minigames: `# WorldGuard Configuration - Minigames Mode
# Generated by NetherGuard Config Manager

# Region settings (strict for competitive)
regions:
  enable: true  
  wand: minecraft:stick
  max-region-count-per-player:
    default: 3

# Protection settings (high security)
protection:
  item-drop-blacklist: ['minecraft:diamond', 'minecraft:netherite_ingot']
  interaction-whitelist: []
  
# Game rules (competitive)
gameplay:
  block-potions: ['minecraft:invisibility_potion']
  disable-health-regain: false
  disable-fall-damage: false

# Arena protection
spawn-protection:
  size: 32
  disable-build-protection: false

# PvP optimized
pvp:
  disable-obsidian-generators: true`
    }
  };

  // Funciones de utilidad
  function showToast(message, type) {
    var container = document.getElementById('toastContainer');
    var toast = document.createElement('div');
    
    var bgClass = type === 'success' ? 'bg-green-600/20 border-green-500/30' : 
                  type === 'error' ? 'bg-red-600/20 border-red-500/30' : 
                  'bg-white/20 border-white/30';
    
    toast.className = 'px-4 py-3 rounded-lg border text-white text-sm font-medium shadow-lg transform transition-all duration-300 translate-x-full ' + bgClass;
    toast.textContent = message;
    
    container.appendChild(toast);
    
    setTimeout(function() { toast.classList.remove('translate-x-full'); }, 10);
    setTimeout(function() {
      toast.classList.add('translate-x-full');
      setTimeout(function() { 
        if (container.contains(toast)) container.removeChild(toast); 
      }, 300);
    }, 3000);
  }

  // Funciones de selecci√≥n
  function selectPlugin(plugin) {
    currentPlugin = plugin;
    
    // Actualizar botones
    var buttons = document.querySelectorAll('.plugin-btn');
    for (var i = 0; i < buttons.length; i++) {
      buttons[i].className = buttons[i].className.replace(' active', '').replace('bg-white text-black', 'bg-white/10 border border-white/20 hover:bg-white/20 text-white');
    }
    
    document.getElementById(plugin + 'Btn').className = document.getElementById(plugin + 'Btn').className.replace('bg-white/10 border border-white/20 hover:bg-white/20 text-white', 'bg-white text-black') + ' active';
  }

  function selectServerType(serverType) {
    currentServerType = serverType;
    
    // Actualizar botones
    var buttons = document.querySelectorAll('.server-btn');
    for (var i = 0; i < buttons.length; i++) {
      buttons[i].className = buttons[i].className.replace(' active', '').replace('bg-white text-black', 'bg-white/10 border border-white/20 hover:bg-white/20 text-white');
    }
    
    document.getElementById(serverType + 'Btn').className = document.getElementById(serverType + 'Btn').className.replace('bg-white/10 border border-white/20 hover:bg-white/20 text-white', 'bg-white text-black') + ' active';
  }

  function selectGamemode(gamemode) {
    selectedGamemode = gamemode;
    
    // Actualizar botones
    var buttons = document.querySelectorAll('.gamemode-btn');
    for (var i = 0; i < buttons.length; i++) {
      buttons[i].className = buttons[i].className
        .replace(' active', '')
        .replace('bg-white text-black', 'bg-white/10 border border-white/20 hover:bg-white/20 text-white');
    }
    
    // Activar bot√≥n seleccionado
    var activeBtn = document.querySelector('.gamemode-btn[data-value="' + gamemode + '"]');
    if (activeBtn) {
      activeBtn.className = activeBtn.className
        .replace('bg-white/10 border border-white/20 hover:bg-white/20 text-white', 'bg-white text-black') + ' active';
    }
    
    // Actualizar hidden input
    document.getElementById('defaultGamemode').value = gamemode;
  }

  // Funci√≥n para generar configuraci√≥n
  function generateConfig() {
    if (isGenerating) return;
    
    isGenerating = true;
    var btn = document.getElementById('generateBtn');
    btn.disabled = true;
    btn.textContent = 'Generating...';

    setTimeout(function() {
      // Obtener valores de los inputs
      var settings = {
        teleportCooldown: document.getElementById('teleportCooldown').value,
        allowDirectHat: document.getElementById('allowDirectHat').checked,
        defaultGamemode: selectedGamemode,
        protectRails: document.getElementById('protectRails').checked,
        maxHomes: document.getElementById('maxHomes').value,
        spawnOnJoin: document.getElementById('spawnOnJoin').checked
      };

      // Obtener template
      var template = configTemplates[currentPlugin][currentServerType];
      
      // Reemplazar valores
      var config = template
        .replace(/{teleportCooldown}/g, settings.teleportCooldown)
        .replace(/{allowDirectHat}/g, settings.allowDirectHat)
        .replace(/{defaultGamemode}/g, settings.defaultGamemode)
        .replace(/{protectRails}/g, settings.protectRails)
        .replace(/{maxHomes}/g, settings.maxHomes)
        .replace(/{spawnOnJoin}/g, settings.spawnOnJoin);

      // Mostrar resultado
      document.getElementById('configOutput').textContent = config;
      document.getElementById('outputSection').classList.remove('hidden');
      
      // Scroll to output
      document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth' });
      
      showToast('Configuration generated successfully!', 'success');
      
      isGenerating = false;
      btn.disabled = false;
      btn.textContent = 'Generate Configuration';
    }, 1000);
  }

  // Funci√≥n para copiar al clipboard
  function copyToClipboard() {
    var config = document.getElementById('configOutput').textContent;
    navigator.clipboard.writeText(config).then(function() {
      showToast('Configuration copied to clipboard!', 'success');
    }).catch(function() {
      showToast('Failed to copy to clipboard', 'error');
    });
  }

  // Funci√≥n para descargar archivo
  function downloadConfig() {
    var config = document.getElementById('configOutput').textContent;
    var filename = currentPlugin + '-' + currentServerType + '.yml';
    
    var blob = new Blob([config], { type: 'text/yaml' });
    var url = URL.createObjectURL(blob);
    var a = document.createElement('a');
    a.href = url;
    a.download = filename;
    a.click();
    URL.revokeObjectURL(url);
    
    showToast('Configuration downloaded!', 'success');
  }

  // Event listeners
  document.addEventListener('DOMContentLoaded', function() {
    // Plugin buttons
    document.getElementById('essentialsBtn').addEventListener('click', function() { selectPlugin('essentials'); });
    document.getElementById('worldguardBtn').addEventListener('click', function() { selectPlugin('worldguard'); });
    document.getElementById('spigotBtn').addEventListener('click', function() { selectPlugin('spigot'); });
    document.getElementById('bukkitBtn').addEventListener('click', function() { selectPlugin('bukkit'); });
    
    // Server type buttons
    document.getElementById('survivalBtn').addEventListener('click', function() { selectServerType('survival'); });
    document.getElementById('creativeBtn').addEventListener('click', function() { selectServerType('creative'); });
    document.getElementById('minigamesBtn').addEventListener('click', function() { selectServerType('minigames'); });
    
    // Gamemode buttons
    var gamemodeButtons = document.querySelectorAll('.gamemode-btn');
    for (var i = 0; i < gamemodeButtons.length; i++) {
      gamemodeButtons[i].addEventListener('click', function() {
        selectGamemode(this.getAttribute('data-value'));
      });
    }
    
    // Generate button
    document.getElementById('generateBtn').addEventListener('click', generateConfig);
    
    // Output buttons
    document.getElementById('copyBtn').addEventListener('click', copyToClipboard);
    document.getElementById('downloadBtn').addEventListener('click', downloadConfig);
  });
</script>

<style>
  .section-spacing {
    @apply py-20 md:py-32;
  }

  .container {
    @apply max-w-7xl mx-auto px-6;
  }

  /* Checkbox personalizado */
  .custom-checkbox {
    position: relative;
    display: inline-flex;
    align-items: center;
    cursor: pointer;
  }

  .custom-checkbox input[type="checkbox"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }

  .custom-checkbox .checkmark {
    position: relative;
    width: 20px;
    height: 20px;
    background-color: transparent;
    border: 2px solid #3f3f46;
    border-radius: 4px;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .custom-checkbox:hover .checkmark {
    border-color: #71717a;
  }

  .custom-checkbox input[type="checkbox"]:checked + .checkmark {
    background-color: #ffffff;
    border-color: #ffffff;
  }

  .custom-checkbox input[type="checkbox"]:checked + .checkmark::after {
    content: "‚úì";
    color: #000000;
    font-size: 14px;
    font-weight: bold;
  }

  /* Quitar flechitas de inputs num√©ricos */
  .no-arrows {
    -moz-appearance: textfield;
  }

  .no-arrows::-webkit-outer-spin-button,
  .no-arrows::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
</style>
